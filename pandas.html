<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PandasPro | DataFrames Masterclass</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://cdn.jsdelivr.net">
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Fira+Code:wght@400;500&display=swap"
        rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/monaco-editor@0.44.0/min/vs/loader.js"></script>
    <script>var _tempDefine = window.define; window.define = undefined;</script>
    <script src="https://cdn.jsdelivr.net/npm/lucide/dist/umd/lucide.min.js"></script>
    <script>window.define = _tempDefine;</script>
    <style>
        :root {
            --bg-primary: #0f1117;
            --bg-secondary: #161a23;
            --bg-tertiary: #1e2532;
            --accent-blue: #06b6d4;
            /* teal for pandas */
            --accent-green: #10b981;
            --accent-red: #ef4444;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --text-muted: #64748b;
            --border-color: #2e3748;
            --sidebar-width: 320px;
            --transition-speed: 0.3s;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-primary);
            color: var(--text-primary);
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        /* ---- Header ---- */
        header {
            background-color: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            z-index: 100;
            flex-shrink: 0;
            height: auto;
            padding: 0;
        }

        .header-top {
            display: flex;
            align-items: center;
            justify-content: space-between;
            width: 100%;
            padding: 0 24px;
            height: 52px;
            gap: 12px;
        }

        .header-bottom {
            width: 100%;
            padding: 0 24px 8px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            font-weight: 700;
            font-size: 1.25rem;
            letter-spacing: -0.025em;
            color: var(--accent-blue);
        }

        .progress-bar-bg {
            height: 6px;
            background: var(--bg-tertiary);
            border-radius: 3px;
            overflow: hidden;
        }

        .progress-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent-blue), #67e8f9);
            width: 0%;
            transition: width 0.5s ease;
        }

        /* Module Tabs */
        .module-tabs {
            display: flex;
            align-items: center;
            gap: 4px;
            background: var(--bg-tertiary);
            padding: 4px;
            border-radius: 10px;
            border: 1px solid var(--border-color);
        }

        .module-tab {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 5px 14px;
            border-radius: 7px;
            font-size: 0.8rem;
            font-weight: 600;
            color: var(--text-muted);
            cursor: pointer;
            text-decoration: none;
            transition: all 0.2s ease;
            border: 1px solid transparent;
            white-space: nowrap;
        }

        .module-tab:hover {
            color: var(--text-primary);
            background: rgba(255, 255, 255, 0.06);
        }

        .module-tab.active {
            background: var(--accent-blue);
            color: #fff;
            box-shadow: 0 2px 10px rgba(6, 182, 212, 0.4);
        }

        .module-tab.coming-soon {
            opacity: 0.45;
            cursor: not-allowed;
            pointer-events: none;
        }

        .module-tab .tab-badge {
            font-size: 0.55rem;
            font-weight: 700;
            padding: 1px 5px;
            border-radius: 4px;
            background: rgba(255, 255, 255, 0.15);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        /* ---- Sidebar ---- */
        .main-wrapper {
            display: flex;
            flex: 1;
            overflow: hidden;
        }

        aside {
            width: var(--sidebar-width);
            background-color: var(--bg-secondary);
            border-right: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            overflow-y: auto;
        }

        /* Collapsible Accordion */
        .category-group {
            border-bottom: 1px solid var(--border-color);
        }

        .category-header {
            padding: 12px 16px;
            font-size: 0.78rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.06em;
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 8px;
            cursor: pointer;
            user-select: none;
            transition: background var(--transition-speed);
            background: var(--bg-secondary);
        }

        .category-header:hover {
            background: var(--bg-tertiary);
        }

        .category-header-left {
            display: flex;
            align-items: center;
            gap: 8px;
            flex: 1;
            min-width: 0;
        }

        .category-header-left span {
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .cat-meta {
            display: flex;
            align-items: center;
            gap: 8px;
            flex-shrink: 0;
        }

        .cat-badge {
            font-size: 0.65rem;
            font-weight: 700;
            padding: 2px 7px;
            border-radius: 20px;
            background: var(--bg-tertiary);
            color: var(--text-muted);
            border: 1px solid var(--border-color);
            transition: all var(--transition-speed);
        }

        .cat-badge.has-progress {
            background: rgba(16, 185, 129, 0.12);
            color: var(--accent-green);
            border-color: rgba(16, 185, 129, 0.3);
        }

        .cat-badge.complete {
            background: rgba(16, 185, 129, 0.2);
            color: var(--accent-green);
            border-color: var(--accent-green);
        }

        .chevron {
            transition: transform 0.25s ease;
            color: var(--text-muted);
            flex-shrink: 0;
        }

        .category-group.open .chevron {
            transform: rotate(180deg);
        }

        .category-group.open .category-header {
            color: var(--text-primary);
        }

        .task-list {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.35s cubic-bezier(0.4, 0, 0.2, 1);
            background: var(--bg-primary);
        }

        .category-group.open .task-list {
            max-height: 600px;
        }

        .cat-progress-strip {
            height: 2px;
            background: var(--bg-tertiary);
        }

        .cat-progress-strip-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent-blue), var(--accent-green));
            transition: width 0.5s ease;
        }

        .sidebar-summary {
            padding: 12px 16px;
            background: var(--bg-tertiary);
            border-bottom: 1px solid var(--border-color);
            font-size: 0.72rem;
            color: var(--text-muted);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .sidebar-summary-bar {
            flex: 1;
            height: 4px;
            background: var(--border-color);
            border-radius: 2px;
            overflow: hidden;
        }

        .sidebar-summary-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent-blue), var(--accent-green));
            border-radius: 2px;
            transition: width 0.5s ease;
        }

        .exercise-item {
            padding: 9px 16px 9px 28px;
            cursor: pointer;
            transition: all var(--transition-speed);
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 0.875rem;
            border-left: 3px solid transparent;
            color: var(--text-secondary);
        }

        .exercise-item:hover {
            background-color: rgba(255, 255, 255, 0.04);
            color: var(--text-primary);
        }

        .exercise-item.active {
            background-color: rgba(6, 182, 212, 0.1);
            border-left-color: var(--accent-blue);
            color: #67e8f9;
        }

        .exercise-item.completed {
            color: var(--accent-green);
        }

        .exercise-item.locked {
            color: var(--text-muted);
            opacity: 0.45;
            cursor: not-allowed;
            pointer-events: none;
        }

        .status-dot {
            width: 7px;
            height: 7px;
            border-radius: 50%;
            background-color: var(--border-color);
            flex-shrink: 0;
        }

        .completed .status-dot {
            background-color: var(--accent-green);
            box-shadow: 0 0 6px var(--accent-green);
        }

        /* ---- Content ---- */
        .content-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            background-color: var(--bg-primary);
        }

        .workspace {
            display: grid;
            grid-template-columns: 1fr 1.2fr;
            flex: 1;
            overflow: hidden;
        }

        .instructions-pane {
            padding: 32px;
            overflow-y: auto;
            background-color: var(--bg-primary);
            border-right: 1px solid var(--border-color);
        }

        h1#task-title {
            font-size: 1.5rem;
            margin-bottom: 16px;
            font-weight: 700;
        }

        .instruction-text {
            color: var(--text-secondary);
            line-height: 1.7;
            margin-bottom: 24px;
            font-size: 1rem;
        }

        .instruction-text code {
            background-color: var(--bg-tertiary);
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Fira Code', monospace;
            color: #5eead4;
            font-size: 0.9em;
        }

        .io-card {
            background-color: var(--bg-secondary);
            border-radius: 12px;
            border: 1px solid var(--border-color);
            margin-bottom: 16px;
            overflow: hidden;
        }

        .io-card-header {
            padding: 12px 16px;
            background-color: var(--bg-tertiary);
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
        }

        .io-card-content {
            padding: 16px;
            font-family: 'Fira Code', monospace;
            font-size: 0.85rem;
            white-space: pre-wrap;
            color: var(--accent-green);
        }

        /* ---- Editor ---- */
        .editor-section {
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .toolbar {
            height: 48px;
            background-color: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            padding: 0 16px;
            gap: 12px;
        }

        #editor-container {
            flex: 1;
        }

        .terminal {
            height: 260px;
            background-color: #000;
            border-top: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
        }

        .terminal-header {
            padding: 8px 16px;
            background-color: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--text-secondary);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        #terminal-output {
            flex: 1;
            padding: 16px;
            overflow-y: auto;
            font-family: 'Fira Code', monospace;
            font-size: 0.85rem;
            line-height: 1.5;
            color: #fff;
            white-space: pre-wrap;
        }

        .text-error {
            color: var(--accent-red);
        }

        .text-success {
            color: var(--accent-green);
        }

        .text-system {
            color: var(--accent-blue);
        }

        /* ---- Buttons ---- */
        .btn {
            padding: 8px 16px;
            border-radius: 6px;
            font-weight: 600;
            font-size: 0.85rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.2s;
            border: none;
            outline: none;
        }

        .btn-primary {
            background-color: var(--accent-blue);
            color: white;
        }

        .btn-primary:hover:not(:disabled) {
            background-color: #0891b2;
            transform: translateY(-1px);
        }

        .btn-success {
            background-color: var(--accent-green);
            color: white;
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        @keyframes pulse {

            0%,
            100% {
                opacity: 0.6;
            }

            50% {
                opacity: 1;
            }
        }

        .loading-pulse {
            animation: pulse 1.5s infinite ease-in-out;
        }

        .coin-container {
            display: flex;
            align-items: center;
            gap: 8px;
            background: rgba(245, 158, 11, 0.1);
            padding: 6px 14px;
            border-radius: 20px;
            border: 1px solid rgba(245, 158, 11, 0.3);
            color: #f59e0b;
            font-weight: 700;
            font-size: 0.9rem;
        }

        /* ---- Reward Overlay ---- */
        .reward-overlay {
            position: fixed;
            inset: 0;
            background: rgba(15, 17, 23, 0.9);
            z-index: 2000;
            display: none;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            backdrop-filter: blur(10px);
        }

        .reward-card {
            background: var(--bg-secondary);
            border: 2px solid var(--accent-blue);
            padding: 48px;
            border-radius: 32px;
            text-align: center;
            animation: reward-pop 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            max-width: 420px;
            width: 90%;
            box-shadow: 0 0 60px rgba(6, 182, 212, 0.35);
        }

        @keyframes reward-pop {
            0% {
                transform: scale(0.4) rotate(-5deg);
                opacity: 0;
            }

            100% {
                transform: scale(1) rotate(0deg);
                opacity: 1;
            }
        }

        .reward-coins {
            font-size: 3.5rem;
            font-weight: 900;
            color: #f59e0b;
            margin: 24px 0;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 16px;
            text-shadow: 0 0 20px rgba(245, 158, 11, 0.5);
        }

        @keyframes coin-float {

            0%,
            100% {
                transform: translateY(0) rotateY(0deg);
            }

            50% {
                transform: translateY(-15px) rotateY(180deg);
            }
        }

        .coin-float {
            animation: coin-float 2s infinite ease-in-out;
        }

        /* ---- Mobile ---- */
        .mobile-warning {
            display: none;
            position: fixed;
            inset: 0;
            background: var(--bg-primary);
            z-index: 1000;
            padding: 40px;
            text-align: center;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }

        @media (max-width: 1024px) {
            .mobile-warning {
                display: flex;
            }
        }

        /* ---- Footer ---- */
        footer {
            height: 32px;
            background-color: var(--bg-secondary);
            border-top: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            color: var(--text-muted);
            z-index: 100;
            flex-shrink: 0;
            gap: 8px;
            white-space: nowrap;
        }
    </style>
</head>

<body>
    <div class="mobile-warning">
        <i data-lucide="monitor" size="48" style="color: var(--accent-blue); margin-bottom: 24px;"></i>
        <h2>Desktop Only Experience</h2>
        <p style="color: var(--text-secondary); margin-top: 12px;">This environment requires a desktop browser.</p>
    </div>

    <header>
        <div class="header-top">
            <div class="logo">
                <i data-lucide="table-2"></i>
                PandasPro
            </div>
            <nav class="module-tabs" role="tablist">
                <a href="https://edusatyaki.github.io/DataMaster/" class="module-tab" id="tab-numpy">
                    <i data-lucide="box" size="13"></i> 1. NumPy
                </a>
                <a href="./matplotlib.html" class="module-tab" id="tab-matplotlib">
                    <i data-lucide="line-chart" size="13"></i> 2. Matplotlib
                </a>
                <a href="./pandas.html" class="module-tab active" id="tab-pandas">
                    <i data-lucide="table-2" size="13"></i> 3. Pandas
                </a>
            </nav>
            <div style="display:flex; align-items:center; gap:10px;">
                <div id="coin-display" class="coin-container">
                    <i data-lucide="coins" size="18"></i>
                    <span id="coin-balance">0</span>
                </div>
                <div id="pyodide-status" class="btn btn-primary loading-pulse"
                    style="background:var(--bg-tertiary); pointer-events:none;">
                    <i data-lucide="loader-2" class="spin"></i>
                    Loading pandas...
                </div>
            </div>
        </div>
        <div class="header-bottom">
            <span style="font-size:0.7rem; color:var(--text-muted); white-space:nowrap;" id="progress-percent">0%
                Completed</span>
            <div class="progress-bar-bg" style="flex:1; max-width:none; margin:0;">
                <div id="progress-bar" class="progress-bar-fill"></div>
            </div>
            <span style="font-size:0.7rem; color:var(--text-muted); white-space:nowrap;" id="progress-fraction">0/30
                Exercises</span>
        </div>
    </header>

    <div class="main-wrapper">
        <aside id="sidebar"></aside>
        <main class="content-area">
            <div class="workspace">
                <div class="instructions-pane">
                    <div id="task-category"
                        style="font-size:0.8rem; color:var(--accent-blue); font-weight:600; margin-bottom:8px; text-transform:uppercase;">
                        Category</div>
                    <h1 id="task-title">Loading Challenge...</h1>
                    <div id="task-instructions" class="instruction-text"></div>
                    <div class="io-card">
                        <div class="io-card-header">Expected Output</div>
                        <div id="task-output" class="io-card-content"></div>
                    </div>
                    <div id="success-message"
                        style="display:none; background:rgba(16,185,129,0.1); border:1px solid var(--accent-green); padding:20px; border-radius:12px; margin-top:24px;">
                        <h3 style="color:var(--accent-green); display:flex; align-items:center; gap:8px;"><i
                                data-lucide="check-circle"></i> Excellent!</h3>
                        <p style="margin-top:8px; font-size:0.9rem; color:var(--text-secondary);">You've mastered this
                            concept.</p>
                        <button id="next-btn" class="btn btn-success"
                            style="margin-top:16px; width:100%; justify-content:center;">Next Exercise <i
                                data-lucide="arrow-right"></i></button>
                    </div>
                </div>
                <div class="editor-section">
                    <div class="toolbar">
                        <div
                            style="flex:1; display:flex; align-items:center; gap:8px; color:var(--text-muted); font-size:0.75rem;">
                            <i data-lucide="file-code" size="14"></i> main.py
                        </div>
                        <button id="run-btn" class="btn btn-primary" disabled>
                            <i data-lucide="play" size="16"></i> Run Code
                        </button>
                    </div>
                    <div id="editor-container"></div>
                    <div class="terminal">
                        <div class="terminal-header">
                            <span>TERMINAL</span>
                            <span id="terminal-status">Ready</span>
                        </div>
                        <pre
                            id="terminal-output"><span class="text-system">Downloading Pyodide and pandas engine...</span></pre>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <div id="reward-overlay" class="reward-overlay">
        <div class="reward-card">
            <h2 style="font-size:1.8rem; color:var(--accent-blue);">CHALLENGE SOLVED!</h2>
            <p style="color:var(--text-secondary); margin-top:12px;">You've earned bamboo coins!</p>
            <div class="reward-coins"><i data-lucide="coins" class="coin-float" size="48"></i> +5</div>
            <button class="btn btn-primary" style="width:100%; height:50px; justify-content:center; font-size:1rem;"
                onclick="document.getElementById('reward-overlay').style.display='none';">CONTINUE</button>
        </div>
    </div>

    <footer>
        <i data-lucide="award" size="14" style="color:var(--accent-blue); opacity:0.8;"></i>
        Ideation &amp; development Satyaki Das | Innovation in Education v_01.0.0
    </footer>

    <script>
        // ============================================================
        //  1. CURRICULUM  â€” 30 pandas challenges across 6 categories
        // ============================================================
        const curriculum = [
            {
                name: "1. Series Basics",
                tasks: [
                    {
                        id: 1, title: "Create a Series",
                        instructions: "Import <code>pandas as pd</code>. Create a Series from <code>[10, 20, 30]</code> and assign it to <code>s</code>. Print <code>s</code>.",
                        starter: "import pandas as pd\n\n# Your code here\n",
                        expected: "0    10\n1    20\n2    30\ndtype: int64",
                        validation: `
try:
    assert 's' in dir(), "Variable 's' not found"
    import pandas as pd
    assert isinstance(s, pd.Series), "s must be a pd.Series"
    assert list(s) == [10, 20, 30], "Values must be [10, 20, 30]"
    print("---TEST_PASSED---")
except Exception as e: print(f"TEST_ERROR: {e}")`
                    },
                    {
                        id: 2, title: "Custom Index",
                        instructions: "Create a Series <code>[100, 200, 300]</code> with index <code>['a', 'b', 'c']</code>. Assign to <code>s</code>.",
                        starter: "import pandas as pd\n\n",
                        expected: "a    100\nb    200\nc    300\ndtype: int64",
                        validation: `
try:
    assert list(s.index) == ['a','b','c'], "Index must be ['a','b','c']"
    assert list(s.values) == [100, 200, 300], "Values incorrect"
    print("---TEST_PASSED---")
except Exception as e: print(f"TEST_ERROR: {e}")`
                    },
                    {
                        id: 3, title: "Series from Dict",
                        instructions: "Create a Series from <code>{'x': 1, 'y': 2, 'z': 3}</code>. Assign to <code>s</code>.",
                        starter: "import pandas as pd\n\n",
                        expected: "x    1\ny    2\nz    3\ndtype: int64",
                        validation: `
try:
    assert list(s.index) == ['x','y','z'], "Keys must be x,y,z"
    assert list(s.values) == [1, 2, 3], "Values incorrect"
    print("---TEST_PASSED---")
except Exception as e: print(f"TEST_ERROR: {e}")`
                    },
                    {
                        id: 4, title: "Series Arithmetic",
                        instructions: "Create <code>s = pd.Series([1, 2, 3])</code> and compute <code>result = s * 2</code>. Print <code>result</code>.",
                        starter: "import pandas as pd\n\n",
                        expected: "0    2\n1    4\n2    6\ndtype: int64",
                        validation: `
try:
    assert list(result) == [2, 4, 6], "result must be [2, 4, 6]"
    print("---TEST_PASSED---")
except Exception as e: print(f"TEST_ERROR: {e}")`
                    },
                    {
                        id: 5, title: "Series Name",
                        instructions: "Create <code>pd.Series([5, 10, 15], name='scores')</code>. Assign to <code>s</code>.",
                        starter: "import pandas as pd\n\n",
                        expected: "Series name: scores",
                        validation: `
try:
    assert s.name == 'scores', "Series name must be 'scores'"
    print("---TEST_PASSED---")
except Exception as e: print(f"TEST_ERROR: {e}")`
                    }
                ]
            },
            {
                name: "2. DataFrame Creation",
                tasks: [
                    {
                        id: 6, title: "DataFrame from Dict",
                        instructions: "Create a DataFrame from <code>{'Name': ['Alice','Bob'], 'Age': [25, 30]}</code>. Assign to <code>df</code>.",
                        starter: "import pandas as pd\n\n",
                        expected: "    Name  Age\n0  Alice   25\n1    Bob   30",
                        validation: `
try:
    assert 'Name' in df.columns and 'Age' in df.columns, "Must have Name and Age columns"
    assert list(df['Name']) == ['Alice','Bob'], "Name column incorrect"
    assert list(df['Age']) == [25, 30], "Age column incorrect"
    print("---TEST_PASSED---")
except Exception as e: print(f"TEST_ERROR: {e}")`
                    },
                    {
                        id: 7, title: "DataFrame Shape",
                        instructions: "Create any DataFrame with <b>3 rows and 2 columns</b>. Assign to <code>df</code>. Print <code>df.shape</code>.",
                        starter: "import pandas as pd\n\n",
                        expected: "(3, 2)",
                        validation: `
try:
    assert df.shape == (3, 2), f"Shape must be (3, 2), got {df.shape}"
    print("---TEST_PASSED---")
except Exception as e: print(f"TEST_ERROR: {e}")`
                    },
                    {
                        id: 8, title: "DataFrame Columns",
                        instructions: "Create a DataFrame with columns <code>['City', 'Population']</code>. Assign to <code>df</code>. Print <code>df.columns.tolist()</code>.",
                        starter: "import pandas as pd\n\n",
                        expected: "['City', 'Population']",
                        validation: `
try:
    assert list(df.columns) == ['City','Population'], "Columns must be ['City','Population']"
    print("---TEST_PASSED---")
except Exception as e: print(f"TEST_ERROR: {e}")`
                    },
                    {
                        id: 9, title: "Custom Row Index",
                        instructions: "Create a DataFrame with <code>index=['r1','r2']</code> and any 2 columns. Assign to <code>df</code>.",
                        starter: "import pandas as pd\n\n",
                        expected: "Index: ['r1', 'r2']",
                        validation: `
try:
    assert list(df.index) == ['r1','r2'], "Index must be ['r1','r2']"
    print("---TEST_PASSED---")
except Exception as e: print(f"TEST_ERROR: {e}")`
                    },
                    {
                        id: 10, title: "DataFrame dtypes",
                        instructions: "Create a DataFrame with a <code>str</code> column 'Name' and an <code>int</code> column 'Score'. Assign to <code>df</code>. Print <code>df.dtypes</code>.",
                        starter: "import pandas as pd\n\n",
                        expected: "Name     object\nScore     int64\ndtype: object",
                        validation: `
try:
    assert 'Name' in df.columns and 'Score' in df.columns, "Must have Name and Score columns"
    assert str(df['Name'].dtype) == 'object', "Name must be object dtype"
    import numpy as np
    assert np.issubdtype(df['Score'].dtype, np.integer), "Score must be integer dtype"
    print("---TEST_PASSED---")
except Exception as e: print(f"TEST_ERROR: {e}")`
                    }
                ]
            },
            {
                name: "3. Selection & Filtering",
                tasks: [
                    {
                        id: 11, title: "Select a Column",
                        instructions: "Given <code>df</code> with columns 'A' and 'B', select column 'A' and assign to <code>col</code>.",
                        starter: "import pandas as pd\ndf = pd.DataFrame({'A': [1, 2, 3], 'B': [4, 5, 6]})\n\n",
                        expected: "0    1\n1    2\n2    3\nName: A, dtype: int64",
                        validation: `
try:
    import pandas as pd
    assert isinstance(col, pd.Series), "col must be a Series"
    assert list(col) == [1, 2, 3], "col must be column A"
    print("---TEST_PASSED---")
except Exception as e: print(f"TEST_ERROR: {e}")`
                    },
                    {
                        id: 12, title: "Select Multiple Columns",
                        instructions: "From <code>df</code> (columns A, B, C), select columns <code>['A','C']</code> and assign to <code>subset</code>.",
                        starter: "import pandas as pd\ndf = pd.DataFrame({'A':[1,2],'B':[3,4],'C':[5,6]})\n\n",
                        expected: "   A  C\n0  1  5\n1  2  6",
                        validation: `
try:
    assert list(subset.columns) == ['A','C'], "Must select A and C"
    print("---TEST_PASSED---")
except Exception as e: print(f"TEST_ERROR: {e}")`
                    },
                    {
                        id: 13, title: "Boolean Filtering",
                        instructions: "Filter <code>df</code> to keep only rows where <code>Age > 25</code>. Assign to <code>filtered</code>.",
                        starter: "import pandas as pd\ndf = pd.DataFrame({'Name':['Alice','Bob','Carol'],'Age':[23,28,31]})\n\n",
                        expected: "    Name  Age\n1    Bob   28\n2  Carol   31",
                        validation: `
try:
    assert list(filtered['Age']) == [28, 31], "Must keep rows where Age > 25"
    print("---TEST_PASSED---")
except Exception as e: print(f"TEST_ERROR: {e}")`
                    },
                    {
                        id: 14, title: "loc Selector",
                        instructions: "Use <code>.loc</code> to select rows with index label <code>'b'</code> from <code>df</code>. Assign to <code>row</code>.",
                        starter: "import pandas as pd\ndf = pd.DataFrame({'X':[10,20,30],'Y':[4,5,6]}, index=['a','b','c'])\n\n",
                        expected: "Row b: X=20, Y=5",
                        validation: `
try:
    assert row['X'] == 20 and row['Y'] == 5, "Must select row b"
    print("---TEST_PASSED---")
except Exception as e: print(f"TEST_ERROR: {e}")`
                    },
                    {
                        id: 15, title: "iloc Selector",
                        instructions: "Use <code>.iloc[0]</code> to get the first row of <code>df</code>. Assign to <code>row</code>.",
                        starter: "import pandas as pd\ndf = pd.DataFrame({'A':[100,200],'B':[300,400]})\n\n",
                        expected: "A    100\nB    300\nName: 0, dtype: int64",
                        validation: `
try:
    assert row['A'] == 100 and row['B'] == 300, "Must select first row"
    print("---TEST_PASSED---")
except Exception as e: print(f"TEST_ERROR: {e}")`
                    }
                ]
            },
            {
                name: "4. Data Manipulation",
                tasks: [
                    {
                        id: 16, title: "Add a Column",
                        instructions: "Add a column <code>'Total'</code> to <code>df</code> which is <code>A + B</code>.",
                        starter: "import pandas as pd\ndf = pd.DataFrame({'A':[1,2,3],'B':[4,5,6]})\n\n",
                        expected: "   A  B  Total\n0  1  4      5\n1  2  5      7\n2  3  6      9",
                        validation: `
try:
    assert 'Total' in df.columns, "Column 'Total' not found"
    assert list(df['Total']) == [5, 7, 9], "Total must be A+B"
    print("---TEST_PASSED---")
except Exception as e: print(f"TEST_ERROR: {e}")`
                    },
                    {
                        id: 17, title: "Drop a Column",
                        instructions: "Drop column <code>'B'</code> from <code>df</code>. Assign result to <code>df</code>.",
                        starter: "import pandas as pd\ndf = pd.DataFrame({'A':[1,2],'B':[3,4],'C':[5,6]})\n\n",
                        expected: "Columns: ['A', 'C']",
                        validation: `
try:
    assert 'B' not in df.columns, "Column B must be dropped"
    assert 'A' in df.columns and 'C' in df.columns, "A and C must remain"
    print("---TEST_PASSED---")
except Exception as e: print(f"TEST_ERROR: {e}")`
                    },
                    {
                        id: 18, title: "Rename Columns",
                        instructions: "Rename column <code>'A'</code> to <code>'Score'</code> in <code>df</code>. Use <code>rename()</code>.",
                        starter: "import pandas as pd\ndf = pd.DataFrame({'A':[10,20],'B':[30,40]})\n\n",
                        expected: "Columns: ['Score', 'B']",
                        validation: `
try:
    assert 'Score' in df.columns, "Must rename A to Score"
    assert 'A' not in df.columns, "A must be gone"
    print("---TEST_PASSED---")
except Exception as e: print(f"TEST_ERROR: {e}")`
                    },
                    {
                        id: 19, title: "Sort by Column",
                        instructions: "Sort <code>df</code> by column <code>'Age'</code> ascending. Assign to <code>sorted_df</code>.",
                        starter: "import pandas as pd\ndf = pd.DataFrame({'Name':['Bob','Alice','Carol'],'Age':[30,23,28]})\n\n",
                        expected: "Sorted: Alice, Carol, Bob",
                        validation: `
try:
    assert list(sorted_df['Age']) == [23, 28, 30], "Must be sorted ascending"
    print("---TEST_PASSED---")
except Exception as e: print(f"TEST_ERROR: {e}")`
                    },
                    {
                        id: 20, title: "Reset Index",
                        instructions: "Filter <code>df</code> to keep rows where <code>Score > 50</code>, then <code>reset_index(drop=True)</code>. Assign to <code>result</code>.",
                        starter: "import pandas as pd\ndf = pd.DataFrame({'Name':['A','B','C'],'Score':[40,80,60]})\n\n",
                        expected: "  Name  Score\n0    B     80\n1    C     60",
                        validation: `
try:
    assert list(result['Score']) == [80, 60], "Must filter Score > 50"
    assert list(result.index) == [0, 1], "Index must be reset"
    print("---TEST_PASSED---")
except Exception as e: print(f"TEST_ERROR: {e}")`
                    }
                ]
            },
            {
                name: "5. Aggregation & GroupBy",
                tasks: [
                    {
                        id: 21, title: "Sum a Column",
                        instructions: "Compute the sum of column <code>'Sales'</code> in <code>df</code>. Assign to <code>total</code>.",
                        starter: "import pandas as pd\ndf = pd.DataFrame({'Sales':[100,200,150]})\n\n",
                        expected: "450",
                        validation: `
try:
    assert total == 450, f"Sum must be 450, got {total}"
    print("---TEST_PASSED---")
except Exception as e: print(f"TEST_ERROR: {e}")`
                    },
                    {
                        id: 22, title: "Mean of a Column",
                        instructions: "Compute the mean of column <code>'Score'</code>. Assign to <code>avg</code>.",
                        starter: "import pandas as pd\ndf = pd.DataFrame({'Score':[80,90,70,100]})\n\n",
                        expected: "85.0",
                        validation: `
try:
    assert avg == 85.0, f"Mean must be 85.0, got {avg}"
    print("---TEST_PASSED---")
except Exception as e: print(f"TEST_ERROR: {e}")`
                    },
                    {
                        id: 23, title: "GroupBy Sum",
                        instructions: "Group <code>df</code> by <code>'Category'</code> and sum <code>'Revenue'</code>. Assign to <code>result</code>.",
                        starter: "import pandas as pd\ndf = pd.DataFrame({'Category':['A','B','A','B'],'Revenue':[100,200,150,250]})\n\n",
                        expected: "Category\nA    250\nB    450\nName: Revenue, dtype: int64",
                        validation: `
try:
    assert result['A'] == 250, "A revenue must be 250"
    assert result['B'] == 450, "B revenue must be 450"
    print("---TEST_PASSED---")
except Exception as e: print(f"TEST_ERROR: {e}")`
                    },
                    {
                        id: 24, title: "GroupBy Mean",
                        instructions: "Group <code>df</code> by <code>'Dept'</code> and compute mean of <code>'Salary'</code>. Assign to <code>result</code>.",
                        starter: "import pandas as pd\ndf = pd.DataFrame({'Dept':['HR','IT','HR','IT'],'Salary':[50,80,60,90]})\n\n",
                        expected: "Dept\nHR    55.0\nIT    85.0\nName: Salary, dtype: float64",
                        validation: `
try:
    assert result['HR'] == 55.0, "HR mean must be 55.0"
    assert result['IT'] == 85.0, "IT mean must be 85.0"
    print("---TEST_PASSED---")
except Exception as e: print(f"TEST_ERROR: {e}")`
                    },
                    {
                        id: 25, title: "Value Counts",
                        instructions: "Use <code>.value_counts()</code> on column <code>'Color'</code> in <code>df</code>. Assign to <code>counts</code>.",
                        starter: "import pandas as pd\ndf = pd.DataFrame({'Color':['Red','Blue','Red','Green','Blue','Red']})\n\n",
                        expected: "Color\nRed      3\nBlue     2\nGreen    1\ndtype: int64",
                        validation: `
try:
    assert counts['Red'] == 3, "Red count must be 3"
    assert counts['Blue'] == 2, "Blue count must be 2"
    assert counts['Green'] == 1, "Green count must be 1"
    print("---TEST_PASSED---")
except Exception as e: print(f"TEST_ERROR: {e}")`
                    }
                ]
            },
            {
                name: "6. Missing Data & Merging",
                tasks: [
                    {
                        id: 26, title: "Detect NaN",
                        instructions: "Check for missing values with <code>.isnull().sum()</code>. Assign result to <code>missing</code>.",
                        starter: "import pandas as pd\nimport numpy as np\ndf = pd.DataFrame({'A':[1,np.nan,3],'B':[np.nan,2,np.nan]})\n\n",
                        expected: "A    1\nB    2\ndtype: int64",
                        validation: `
try:
    assert missing['A'] == 1, "A must have 1 NaN"
    assert missing['B'] == 2, "B must have 2 NaNs"
    print("---TEST_PASSED---")
except Exception as e: print(f"TEST_ERROR: {e}")`
                    },
                    {
                        id: 27, title: "Fill NaN",
                        instructions: "Fill all NaN values in <code>df</code> with <code>0</code> using <code>.fillna()</code>. Assign to <code>filled</code>.",
                        starter: "import pandas as pd\nimport numpy as np\ndf = pd.DataFrame({'A':[1,np.nan],'B':[np.nan,4]})\n\n",
                        expected: "     A    B\n0  1.0  0.0\n1  0.0  4.0",
                        validation: `
try:
    assert filled.isnull().sum().sum() == 0, "No NaN should remain"
    assert filled['A'][1] == 0 and filled['B'][0] == 0, "NaNs must be 0"
    print("---TEST_PASSED---")
except Exception as e: print(f"TEST_ERROR: {e}")`
                    },
                    {
                        id: 28, title: "Drop NaN Rows",
                        instructions: "Drop rows with any NaN from <code>df</code> using <code>.dropna()</code>. Assign to <code>clean</code>.",
                        starter: "import pandas as pd\nimport numpy as np\ndf = pd.DataFrame({'A':[1,np.nan,3],'B':[4,5,np.nan]})\n\n",
                        expected: "   A    B\n0  1.0  4.0",
                        validation: `
try:
    assert len(clean) == 1, "Only 1 complete row should remain"
    assert clean.isnull().sum().sum() == 0, "No NaN should remain"
    print("---TEST_PASSED---")
except Exception as e: print(f"TEST_ERROR: {e}")`
                    },
                    {
                        id: 29, title: "Merge DataFrames",
                        instructions: "Merge <code>df1</code> and <code>df2</code> on column <code>'ID'</code> (inner join). Assign to <code>merged</code>.",
                        starter: "import pandas as pd\ndf1 = pd.DataFrame({'ID':[1,2,3],'Name':['A','B','C']})\ndf2 = pd.DataFrame({'ID':[2,3,4],'Score':[90,85,70]})\n\n",
                        expected: "   ID Name  Score\n0   2    B     90\n1   3    C     85",
                        validation: `
try:
    assert len(merged) == 2, "Inner join must produce 2 rows"
    assert list(merged['ID']) == [2, 3], "IDs must be 2 and 3"
    assert 'Name' in merged.columns and 'Score' in merged.columns
    print("---TEST_PASSED---")
except Exception as e: print(f"TEST_ERROR: {e}")`
                    },
                    {
                        id: 30, title: "Concatenate DataFrames",
                        instructions: "Concatenate <code>df1</code> and <code>df2</code> with <code>pd.concat()</code> and <code>ignore_index=True</code>. Assign to <code>combined</code>.",
                        starter: "import pandas as pd\ndf1 = pd.DataFrame({'X':[1,2]})\ndf2 = pd.DataFrame({'X':[3,4]})\n\n",
                        expected: "   X\n0  1\n1  2\n2  3\n3  4",
                        validation: `
try:
    assert list(combined['X']) == [1, 2, 3, 4], "Must concatenate rows"
    assert list(combined.index) == [0, 1, 2, 3], "Index must be reset"
    print("---TEST_PASSED---")
except Exception as e: print(f"TEST_ERROR: {e}")`
                    }
                ]
            }
        ];

        // ============================================================
        //  2. STATE
        // ============================================================
        let currentExerciseIndex = 0;
        const allTasks = curriculum.flatMap(c => c.tasks.map(t => ({ ...t, category: c.name })));
        let completedSet = new Set();
        let totalCoins = 0;
        let editor;
        let isEngineReady = false;

        // ============================================================
        //  3. IndexedDB
        // ============================================================
        const DB_NAME = "PandasProDB";
        const STORE_NAME = "pandas_mastery";
        async function initDB() {
            return new Promise((resolve, reject) => {
                const req = indexedDB.open(DB_NAME, 1);
                req.onupgradeneeded = e => { const db = e.target.result; if (!db.objectStoreNames.contains(STORE_NAME)) db.createObjectStore(STORE_NAME); };
                req.onsuccess = e => resolve(e.target.result);
                req.onerror = e => reject(e.target.error);
            });
        }
        async function loadProgress() {
            try {
                const db = await initDB();
                return new Promise(resolve => {
                    const tx = db.transaction(STORE_NAME, "readonly");
                    const req = tx.objectStore(STORE_NAME).get("progress_data");
                    req.onsuccess = () => { const d = req.result || { completed: [], coins: 0 }; completedSet = new Set(d.completed); totalCoins = d.coins; resolve(); };
                });
            } catch (e) { console.error(e); }
        }
        async function saveProgress() {
            try {
                const db = await initDB();
                const tx = db.transaction(STORE_NAME, "readwrite");
                tx.objectStore(STORE_NAME).put({ completed: Array.from(completedSet), coins: totalCoins }, "progress_data");
            } catch (e) { console.error(e); }
        }

        // ============================================================
        //  4. DOM References
        // ============================================================
        const sidebar = document.getElementById('sidebar');
        const runBtn = document.getElementById('run-btn');
        const nextBtn = document.getElementById('next-btn');
        const terminalOutput = document.getElementById('terminal-output');
        const pyodideStatus = document.getElementById('pyodide-status');
        const progressBar = document.getElementById('progress-bar');
        const progressPct = document.getElementById('progress-percent');
        const progressFrac = document.getElementById('progress-fraction');
        const successMsg = document.getElementById('success-message');
        const taskTitle = document.getElementById('task-title');
        const taskCat = document.getElementById('task-category');
        const taskInstr = document.getElementById('task-instructions');
        const taskOutput = document.getElementById('task-output');

        function safeCreateIcons() { if (typeof lucide !== 'undefined') lucide.createIcons(); }

        // ============================================================
        //  5. Pyodide Worker
        // ============================================================
        const workerCode = `
importScripts("https://cdn.jsdelivr.net/pyodide/v0.25.0/full/pyodide.js");
async function init() {
    try {
        self.postMessage({ type: 'status', msg: 'Downloading core runtime...' });
        const pyodide = await loadPyodide({ indexURL: "https://cdn.jsdelivr.net/pyodide/v0.25.0/full/" });
        self.postMessage({ type: 'status', msg: 'Installing pandas...' });
        await pyodide.loadPackage(["pandas","numpy"]);
        self.postMessage({ type: 'ready' });
        return pyodide;
    } catch(e) { self.postMessage({ type: 'error', message: e.message }); }
}
let ready = init();
self.onmessage = async event => {
    const pyodide = await ready;
    if (!pyodide) return;
    try {
        let out = "";
        pyodide.setStdout({ batched: s => { out += s + "\\n"; } });
        pyodide.setStderr({ batched: s => { out += s + "\\n"; } });
        await pyodide.runPythonAsync(event.data.code);
        self.postMessage({ type: 'result', output: out, success: true });
    } catch(err) { self.postMessage({ type: 'result', error: err.message, success: false }); }
};`;
        const worker = new Worker(URL.createObjectURL(new Blob([workerCode], { type: "application/javascript" })));

        worker.onmessage = e => {
            const d = e.data;
            if (d.type === 'status') {
                pyodideStatus.innerHTML = `<i data-lucide="loader-2" class="spin" size="14"></i> ${d.msg}`;
                terminalOutput.textContent = d.msg;
                safeCreateIcons(); return;
            }
            if (d.type === 'ready') {
                isEngineReady = true;
                pyodideStatus.innerHTML = '<i data-lucide="zap" size="16"></i> pandas Ready';
                pyodideStatus.style.background = 'var(--accent-green)';
                pyodideStatus.classList.remove('loading-pulse');
                runBtn.disabled = false;
                terminalOutput.textContent = "Python 3.11 + pandas initialized.\nSelect a task and start coding.";
                safeCreateIcons(); return;
            }
            if (d.type === 'result') {
                runBtn.disabled = false;
                runBtn.innerHTML = '<i data-lucide="play" size="16"></i> Run Code';
                safeCreateIcons();
                if (d.success) {
                    const clean = (d.output || "").replace("---TEST_PASSED---\n", "").trim();
                    terminalOutput.textContent = clean || "(no output)";
                    if (d.output && d.output.includes("---TEST_PASSED---")) {
                        markComplete(currentExerciseIndex);
                        successMsg.style.display = 'block';
                        terminalOutput.textContent += '\n\nâœ… Test Passed! Excellent work.';
                    }
                } else {
                    terminalOutput.innerHTML = `<span class="text-error">ERROR:\n${d.error}</span>`;
                }
            }
        };

        // ============================================================
        //  6. Sidebar Accordion
        // ============================================================
        function renderSidebar() {
            sidebar.innerHTML = '';
            const totalCompleted = completedSet.size;
            const totalTasks = allTasks.length;
            const summaryPct = totalTasks > 0 ? Math.round((totalCompleted / totalTasks) * 100) : 0;
            const sumDiv = document.createElement('div');
            sumDiv.className = 'sidebar-summary';
            sumDiv.innerHTML = `<span>${totalCompleted}/${totalTasks} done</span><div class="sidebar-summary-bar"><div class="sidebar-summary-bar-fill" style="width:${summaryPct}%"></div></div><span>${summaryPct}%</span>`;
            sidebar.appendChild(sumDiv);

            curriculum.forEach(cat => {
                const catTasks = cat.tasks;
                const done = catTasks.filter(t => completedSet.has(t.id)).length;
                const pct = catTasks.length > 0 ? Math.round((done / catTasks.length) * 100) : 0;
                const allDone = done === catTasks.length;
                const containsActive = catTasks.some(t => allTasks.findIndex(a => a.id === t.id) === currentExerciseIndex);

                const group = document.createElement('div');
                group.className = 'category-group' + (containsActive ? ' open' : '');

                const badgeClass = allDone ? 'cat-badge complete' : done > 0 ? 'cat-badge has-progress' : 'cat-badge';
                const badgeText = allDone ? 'âœ“ Done' : `${done}/${catTasks.length}`;

                const header = document.createElement('div');
                header.className = 'category-header';
                header.innerHTML = `
                <div class="category-header-left">
                    <i data-lucide="folder" size="13" style="color:var(--accent-blue);flex-shrink:0"></i>
                    <span>${cat.name}</span>
                </div>
                <div class="cat-meta">
                    <span class="${badgeClass}">${badgeText}</span>
                    <i data-lucide="chevron-down" size="14" class="chevron"></i>
                </div>`;

                const strip = document.createElement('div');
                strip.className = 'cat-progress-strip';
                strip.innerHTML = `<div class="cat-progress-strip-fill" style="width:${pct}%"></div>`;

                const taskList = document.createElement('div');
                taskList.className = 'task-list';

                catTasks.forEach(task => {
                    const idx = allTasks.findIndex(t => t.id === task.id);
                    const isCompleted = completedSet.has(task.id);
                    const isLocked = idx > 0 && !completedSet.has(allTasks[idx - 1].id);
                    const item = document.createElement('div');
                    item.className = `exercise-item ${idx === currentExerciseIndex ? 'active' : ''} ${isCompleted ? 'completed' : ''} ${isLocked ? 'locked' : ''}`;
                    let icon = isLocked ? '<i data-lucide="lock" size="12"></i>' : '<div class="status-dot"></div>';
                    if (isCompleted) icon = '<i data-lucide="check-circle" size="12"></i>';
                    item.innerHTML = `${icon} <span style="flex:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">${task.title}</span>`;
                    if (!isLocked) item.onclick = () => loadExercise(idx);
                    taskList.appendChild(item);
                });

                header.addEventListener('click', () => group.classList.toggle('open'));
                group.appendChild(header);
                group.appendChild(strip);
                group.appendChild(taskList);
                sidebar.appendChild(group);
            });
            updateProgress();
            safeCreateIcons();
        }

        // ============================================================
        //  7. Core Logic
        // ============================================================
        function loadExercise(index) {
            currentExerciseIndex = index;
            const task = allTasks[index];
            taskTitle.innerText = task.title;
            taskCat.innerText = task.category;
            taskInstr.innerHTML = task.instructions;
            taskOutput.innerText = task.expected;
            successMsg.style.display = 'none';
            if (isEngineReady) terminalOutput.textContent = "Terminal ready...";
            if (editor) editor.setValue(task.starter);
            document.querySelectorAll('.exercise-item').forEach((el, i) => el.classList.toggle('active', i === index));
        }

        function markComplete(index) {
            const task = allTasks[index];
            if (!completedSet.has(task.id)) {
                completedSet.add(task.id);
                totalCoins += 5;
                saveProgress();
                document.getElementById('reward-overlay').style.display = 'flex';
                safeCreateIcons();
            }
            renderSidebar();
        }

        function updateProgress() {
            const total = allTasks.length;
            const completed = completedSet.size;
            const pct = Math.round((completed / total) * 100);
            progressBar.style.width = `${pct}%`;
            progressPct.innerText = `${pct}% Completed`;
            progressFrac.innerText = `${completed}/${total} Exercises`;
            document.getElementById('coin-balance').innerText = totalCoins;
        }

        // ============================================================
        //  8. Monaco Editor
        // ============================================================
        require.config({ paths: { 'vs': 'https://cdn.jsdelivr.net/npm/monaco-editor@0.44.0/min/vs' } });
        require(['vs/editor/editor.main'], function () {
            editor = monaco.editor.create(document.getElementById('editor-container'), {
                value: allTasks[0].starter,
                language: 'python',
                theme: 'vs-dark',
                automaticLayout: true,
                minimap: { enabled: false },
                fontSize: 14,
                fontFamily: "'Fira Code', monospace",
                padding: { top: 20 },
                roundedSelection: true,
                scrollBeyondLastLine: false
            });
            startApp();
        });

        // ============================================================
        //  9. Event Handlers
        // ============================================================
        runBtn.addEventListener('click', () => {
            const userCode = editor.getValue();
            const validation = allTasks[currentExerciseIndex].validation;
            terminalOutput.innerHTML = '<span class="text-system">Executing...</span>';
            runBtn.disabled = true;
            runBtn.innerText = "âš™ï¸ Working...";
            successMsg.style.display = 'none';
            const fullCode = `${userCode}\n${validation}`;
            worker.postMessage({ code: fullCode });
        });

        nextBtn.addEventListener('click', () => {
            document.getElementById('reward-overlay').style.display = 'none';
            if (currentExerciseIndex < allTasks.length - 1) loadExercise(currentExerciseIndex + 1);
            else alert("ðŸŽ‰ Congratulations! You've completed the entire Pandas course!");
        });

        async function startApp() {
            await loadProgress();
            renderSidebar();
            loadExercise(0);
            safeCreateIcons();
        }
    </script>
</body>

</html>
